{%- from "collectd/map.jinja" import collectd_settings with context %}
#
# DO NOT EDIT
#
# This file is managed by salt via {{ source }}
# Modify the config that generates this file instead
#

LoadPlugin postgresql

<Plugin "postgresql">
{%- for query in collectd_settings.plugins.postgresql.queries %}
  <Query {{ query.name }}>
          Statement "{{ query.statement }}"
          <Result>
            Type {{ query.result_type }}
            InstancePrefix "{{ query.instanceprefix }}"
            InstancesFrom "{{ query.instancefrom }}"
            ValuesFrom "{{ query.valuefrom }}"
          </Result>
  </Query>
{%- endfor %}

{%- for db in collectd_settings.plugins.postgresql.databases %}
  <Database {{ db.name }}>
    Host "{{ db.host }}"
    Port "{{ db.port }}"
    User "{{ db.user }}"
    Password "{{ db.pass }}"
    Database "{{ db.name }}"
  {%- for query in collectd_settings.plugins.postgresql.queries %}
    Query "{{ query.name }}"
  {%- endfor %}
    Interval "{{ db.interval }}"
  </Database>
{%- endfor %}
</Plugin>